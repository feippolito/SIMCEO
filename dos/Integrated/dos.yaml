simulation:
  sampling frequency: 2000
  duration: 150
  server:
    IP: 127.0.0.1

drivers:
  M1:
    delay: 0
    sampling_rate: 2000
    inputs:
      Txyz:
        lien: [FEM, OSS_M1_Translation]
      Rxyz:
        lien: ['FEM', OSS_M1_Rotation]
      modes:
        lien: [AcO_controller, M1 BM]

  M2:
    delay: 0
    sampling_rate: 2000
    inputs:
      Txyz:
        lien: [AcO_controller ,M2 Txyz]
      Rxyz:
        lien: [AcO_controller ,M2 Rxyz]

  wfs48:
    delay: 0
    sampling_rate: 2000
    outputs:
      M12_RBM:
        sampling_rate: 2000
        size: 273
        logs: {decimation: 2000}

  AcO_controller:
    server: false
    sampling_rate: 20000
    inputs:
      x_hat:
        lien: [wfs48, M12_RBM]
    shape: [7, 39]
    split:
      indices_or_sections: [6, 9, 12]
      axis: 1
    outputs:
      M1 TxyzRxyz:
        size: [7, 6]
        sampling_rate: 20000
        logs: {decimation: 20000}
      M2 Txyz:
        size: [7, 3]
        sampling_rate: 20000
        logs: {decimation: 20000}
      M2 Rxyz:
        sampling_rate: 20000
        size: [7, 3]
        logs: {decimation: 20000}
      M1 BM:
        size: [7, 27]
        sampling_rate: 20000
        logs: {decimation: 20000}

  M1Pos0:
    sampling_rate: 1
    server: false
    inputs:
      TxyzRxyz:
        lien: [AcO_controller, M1 TxyzRxyz]
    outputs:
      M1Pos_DeltaF:
        size: 42
        logs: {decimation: 1}

  Mount:
    sampling_rate: 1
    server: false
    inputs:
      MountFeedback_1:
        lien: [FEM, OSS_AzDrive_D]
      MountFeedback_2:
        lien: [FEM, OSS_ElDrive_D]
      MountFeedback_3:
        lien: [FEM, OSS_GIRDrive_D]
    split:
      indices_or_sections: [8,16]
      axis: 1
    outputs:
      Mount_AzDrive_F:
        size: 8
        logs: {decimation: 1}
      Mount_ElDrive_F:
        size: 8
        logs: {decimation: 1}
      Mount_GIRDrive_F:
        size: 4
        logs: {decimation: 1}

  M1LocalControl0:
    sampling_rate: 1
    server: false
    inputs:
      HP_F_Meas:
        lien: [M1HPloadcells0, M1_HP_F_meas]
    split:
      indices_or_sections: [335, 670, 1005, 1340, 1675, 2010]
      axis: 1
    outputs:
      M1_Rel_F_S1:
        size: 335
      M1_Rel_F_S2:
        size: 335
      M1_Rel_F_S3:
        size: 335
      M1_Rel_F_S4:
        size: 335
      M1_Rel_F_S5:
        size: 335
      M1_Rel_F_S6:
        size: 335
      M1_Rel_F_S7:
        size: 306

  FEM:
    inputs:
      #M1Ofl
      OSS_AzDrive_F:
        lien: [Mount,Mount_AzDrive_F]
      OSS_ElDrive_F:
        lien: [Mount,Mount_ElDrive_F]
      OSS_GIRDrive_F:
        lien: [Mount, Mount_GIRDrive_F]
      OSS_Harpoint_delta_F:
        lien: [M1Pos0, M1Pos_DeltaF]
      M1_actuators_segment_1:
        lien: [M1LocalControl0, M1_Rel_F_S1]
      M1_actuators_segment_2:
        lien: [M1LocalControl0, M1_Rel_F_S2]
      M1_actuators_segment_3:
        lien: [M1LocalControl0, M1_Rel_F_S3]
      M1_actuators_segment_4:
        lien: [M1LocalControl0, M1_Rel_F_S4]
      M1_actuators_segment_5:
        lien: [M1LocalControl0, M1_Rel_F_S5]
      M1_actuators_segment_6:
        lien: [M1LocalControl0, M1_Rel_F_S6]
      M1_actuators_segment_7:
        lien: [M1LocalControl0, M1_Rel_F_S7]
    outputs:
      #Mount
      OSS_AzDrive_D:
        logs: {decimation: 1}
        size: 8
      OSS_ElDrive_D:
        logs: {decimation: 1}
        size: 8
      OSS_GIRDrive_D:
        logs: {decimation: 1}
        size: 4
      #M1
      OSS_M1_lcl:
        size: 42
        logs: {decimation: 1}
      #M1 HP loadcells
      OSS_Hardpoint_D:
        size: 84
        logs: {decimation: 1}
      #Reshape M1
      OSS_M1_Translation:
        size: [7, 3]
        logs: {decimation: 1}
      OSS_M1_Rotation:
        size: [7, 3]
        logs: {decimation: 1}

  M1HPloadcells0:
    sampling_rate: 1
    server: false
    inputs:
      M1_HP_cmd:
        size: 42
        lien: [M1Pos0, M1Pos_DeltaF]
      M1_HP_D:
        size: 84
        lien: [FEM, OSS_Hardpoint_D]
    outputs:
      M1_HP_F_meas:
        size: 42
        logs: {decimation: 1}

COMMENTS:
  science:
    sampling_rate: 2000
    outputs:
      wfe_rms:
        size: 1
        logs: {decimation: 2000}
      segment_wfe_rms:
        size: 7
        logs: {decimation: 2000}
      PSSn:
        size: 1
        logs: {decimation: 2000}
      tiptilt:
        size: 2
        logs: {decimation: 2000}
      segment_piston:
        size: 7
        logs: {decimation: 2000}
      segment_tiptilt:
        size: 14
        logs: {decimation: 2000}